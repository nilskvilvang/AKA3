<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Kapittel 11 Polynomisk regresjon | Anvendt kvantitativ analyse</title>
<meta name="author" content="Nils Kvilvang">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="Kapittel 11 Polynomisk regresjon | Anvendt kvantitativ analyse">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Kapittel 11 Polynomisk regresjon | Anvendt kvantitativ analyse">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<link href="libs/tabwid-1.0.0/scrool.css" rel="stylesheet">
<link href="libs/table1-1.0/table1_defaults.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.9/grViz.js"></script><script src="libs/plotly-binding-4.10.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content='Anta at vi har lønnsdata fra en bedrift som har regnet ut snittlønn for de 10 stillingskategoriene de har av ansatte. polydata &lt;- read_excel("polydata.xlsx") Download polydata.xlsx...'>
<meta property="og:description" content='Anta at vi har lønnsdata fra en bedrift som har regnet ut snittlønn for de 10 stillingskategoriene de har av ansatte. polydata &lt;- read_excel("polydata.xlsx") Download polydata.xlsx...'>
<meta name="twitter:description" content='Anta at vi har lønnsdata fra en bedrift som har regnet ut snittlønn for de 10 stillingskategoriene de har av ansatte. polydata &lt;- read_excel("polydata.xlsx") Download polydata.xlsx...'>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Anvendt kvantitativ analyse</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introduksjon</a></li>
<li><a class="" href="hvorfor-dette-notatet.html"><span class="header-section-number">1</span> Hvorfor dette notatet?</a></li>
<li><a class="" href="grunnleggende-begreper-og-sammenhenger.html"><span class="header-section-number">2</span> Grunnleggende begreper og sammenhenger</a></li>
<li><a class="" href="samvariasjon-og-korrelasjon.html"><span class="header-section-number">3</span> Samvariasjon og korrelasjon</a></li>
<li><a class="" href="univariat-analyse.html"><span class="header-section-number">4</span> Univariat analyse</a></li>
<li><a class="" href="kjikvadrattest---analyse-av-kategoriske-data.html"><span class="header-section-number">5</span> Kjikvadrattest - Analyse av kategoriske data</a></li>
<li><a class="" href="t-tester.html"><span class="header-section-number">6</span> T-tester</a></li>
<li><a class="" href="variansanalyse---anova-analysis-of-variance.html"><span class="header-section-number">7</span> Variansanalyse - ANOVA (“Analysis of Variance”)</a></li>
<li><a class="" href="variansanalyse---manova-multivariate-analysis-of-variance.html"><span class="header-section-number">8</span> Variansanalyse - MANOVA (“Multivariate Analysis of Variance”)</a></li>
<li><a class="" href="regresjonsanalyse---ols.html"><span class="header-section-number">9</span> Regresjonsanalyse - OLS</a></li>
<li><a class="" href="iv-regresjon.html"><span class="header-section-number">10</span> IV regresjon</a></li>
<li><a class="active" href="polynomisk-regresjon.html"><span class="header-section-number">11</span> Polynomisk regresjon</a></li>
<li><a class="" href="logistisk-regresjon.html"><span class="header-section-number">12</span> Logistisk regresjon</a></li>
<li><a class="" href="structural-equation-modelling-sem---strukturelle-regresjonsmodeller.html"><span class="header-section-number">13</span> Structural Equation Modelling (SEM - Strukturelle Regresjonsmodeller)</a></li>
<li><a class="" href="dimension-reduction-factor-analysis-fa-og-principal-component-analysis-pca.html"><span class="header-section-number">14</span> Dimension reduction: Factor Analysis (FA) og Principal Component Analysis (PCA)</a></li>
<li><a class="" href="maskinl%C3%A6ring-machine-learning.html"><span class="header-section-number">15</span> Maskinlæring (Machine Learning)</a></li>
<li><a class="" href="referanser.html">Referanser</a></li>
<li><a class="" href="vedlegg-a---sentralgrenseteoremet-central-limit-theorem.html">Vedlegg A - Sentralgrenseteoremet (Central Limit Theorem)</a></li>
<li><a class="" href="vedlegg-b---chebyshevs-teorem.html">Vedlegg B - Chebyshevs teorem</a></li>
<li><a class="" href="vedlegg-x---session-info.html">Vedlegg X - Session Info</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/nilskvilvang/AKA3">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="polynomisk-regresjon" class="section level1" number="11">
<h1>
<span class="header-section-number">Kapittel 11</span> Polynomisk regresjon<a class="anchor" aria-label="anchor" href="#polynomisk-regresjon"><i class="fas fa-link"></i></a>
</h1>
<p>Anta at vi har lønnsdata fra en bedrift som har regnet ut snittlønn for de 10 stillingskategoriene de har av ansatte.</p>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">polydata</span> <span class="op">&lt;-</span> <span class="fu">read_excel</span><span class="op">(</span><span class="st">"polydata.xlsx"</span><span class="op">)</span></code></pre></div>
<p><a href="data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,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" download="polydata.xlsx">Download polydata.xlsx</a></p>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">glimpse</span><span class="op">(</span><span class="va">polydata</span><span class="op">)</span>
<span class="co">#&gt; Rows: 10</span>
<span class="co">#&gt; Columns: 2</span>
<span class="co">#&gt; $ Stillingskategori &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10</span>
<span class="co">#&gt; $ Snittlonn         &lt;dbl&gt; 35000, 41000, 48000, 63000, 8800…</span></code></pre></div>
<p>Vi kan se på en enkel lineær regresjon med disse dataene:</p>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">enkelOLS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Snittlonn</span> <span class="op">~</span> <span class="va">Stillingskategori</span>, data <span class="op">=</span> <span class="va">polydata</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">polydata</span><span class="op">$</span><span class="va">Stillingskategori</span>, y <span class="op">=</span> <span class="va">polydata</span><span class="op">$</span><span class="va">Snittlonn</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">polydata</span><span class="op">$</span><span class="va">Stillingskategori</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">polydata</span><span class="op">$</span><span class="va">Stillingskategori</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">polydata</span><span class="op">$</span><span class="va">Stillingskategori</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">enkelOLS</span>, newdata <span class="op">=</span> <span class="va">polydata</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Enkel OLS"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Stillingskategori"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Snittlønn"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="11_Kap_11_files/figure-html/unnamed-chunk-5-1.png" width="672"></div>
<p>Vi kunne kanskje ane dette ut fra dataene (og fordi det selvsagt er et eksempel der vanlig lineær regresjon ikke skal funke så bra…). Det synes i hvert fall klart at den lineære regresjonslinja sannsynligvis er en dårlig modell for lønnsdataene.</p>
<p>Fra kapittelet om enkel, lineær regresjon vet vi at vi kan uttrykke regresjonslinja slik:</p>
<p><span class="math inline">\(y=\alpha + \beta x\)</span></p>
<p>Vi kan videre uttrykke en multippel regresjon slik:</p>
<p><span class="math inline">\(y=\alpha + \beta_1x_1 + \beta_2x_2 +\ ...\ +\beta_nx_n\)</span></p>
<p>En polynomisk regresjonslikning likner, men her introduserer vi “i n-te ledd”:</p>
<p><span class="math inline">\(y=\alpha + \beta_1x_1 + \beta_2x_1^2+\ ...\ +\beta_nx_1^n\)</span></p>
<p>Selv om dette sikkert er kjent er det greit å illustrere ulike n’te-ledd grafisk:</p>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">funksjonsgrafer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">^</span><span class="fl">4</span><span class="op">}</span>, color<span class="op">=</span><span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>        
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">^</span><span class="fl">3</span><span class="op">}</span>, color<span class="op">=</span><span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> 
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fl">4</span><span class="op">*</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">}</span>, color<span class="op">=</span><span class="st">"orange"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fl">10</span><span class="op">*</span><span class="va">x</span><span class="op">}</span>, color<span class="op">=</span><span class="st">"purple"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">"text"</span>, label <span class="op">=</span> <span class="st">"Quartic"</span>, x <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>, y <span class="op">=</span> <span class="fl">200</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span> 
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">"text"</span>, label <span class="op">=</span> <span class="st">"Quadratic"</span>, x <span class="op">=</span> <span class="op">-</span><span class="fl">4.6</span>, y <span class="op">=</span> <span class="fl">107</span>, size <span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">"text"</span>, label <span class="op">=</span> <span class="st">"Cubic"</span>, x <span class="op">=</span> <span class="op">-</span><span class="fl">3.8</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">90</span>, size <span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span> 
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">"text"</span>, label <span class="op">=</span> <span class="st">"Linear"</span>, x <span class="op">=</span> <span class="op">-</span><span class="fl">4.6</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">32</span>, size <span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span>

<span class="va">funksjonsgrafer</span></code></pre></div>
<div class="inline-figure"><img src="11_Kap_11_files/figure-html/unnamed-chunk-6-1.png" width="672"></div>
<p>Imidlertid er vi sjeldent interessert i negative x-verdier i praktisk bruk (matematisk er det selvsagt interessant, men som sagt sjeldent i anvendt analyse som vi driver med).</p>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">funksjonsgrafer2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">^</span><span class="fl">4</span><span class="op">}</span>, color<span class="op">=</span><span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>        
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">^</span><span class="fl">3</span><span class="op">}</span>, color<span class="op">=</span><span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> 
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fl">4</span><span class="op">*</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">}</span>, color<span class="op">=</span><span class="st">"orange"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fl">10</span><span class="op">*</span><span class="va">x</span><span class="op">}</span>, color<span class="op">=</span><span class="st">"purple"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">"text"</span>, label <span class="op">=</span> <span class="st">"Quartic"</span>, x <span class="op">=</span> <span class="fl">4.2</span>, y <span class="op">=</span> <span class="fl">200</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span> 
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">"text"</span>, label <span class="op">=</span> <span class="st">"Quadratic"</span>, x <span class="op">=</span> <span class="fl">4.8</span>, y <span class="op">=</span> <span class="fl">75</span>, size <span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">"text"</span>, label <span class="op">=</span> <span class="st">"Cubic"</span>, x <span class="op">=</span> <span class="fl">4.5</span>, y <span class="op">=</span> <span class="fl">120</span>, size <span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span> 
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">"text"</span>, label <span class="op">=</span> <span class="st">"Linear"</span>, x <span class="op">=</span> <span class="fl">4.8</span>, y <span class="op">=</span> <span class="fl">40</span>, size <span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span> <span class="op">+</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>

<span class="va">funksjonsgrafer2</span></code></pre></div>
<div class="inline-figure"><img src="11_Kap_11_files/figure-html/unnamed-chunk-7-1.png" width="672"></div>
<p>Vi skal nedenfor vise hvordan vi kan utvikle polynomisk regresjon, men det er på sin plass å komme med en liten advarsel. Vi kan, som nevnt, i prinsippet ha så mange med så mange ledd vi vil, og muligens vil vi få bedre og bedre “fit” til dataene jo flere vi legger til. Det betyr imidlertid ikke at modellen blir bedre og bedre til å predikere framtidige verdier. Vi kan få det vi kaller overtilpasning (“overfitting”), dvs at modellen vår passer helt utmerket til dataene våre, men at modellen ikke vil klare å predikere nye verdier med særlig god treffsikkerhet. Det er alltid en avveining mellom å få en modell som er godt tilpasset dataene, predikativ evne og modellens kompleksitet/enkelhet (alt annet likt foretrekker vi som regel enklere modeller framfor komplekse modeller). Vi skal altså alltid være bevisst på hva vi gjør i polynomisk regresjon (som med alt annet selvsagt…).</p>
<p>Et annet punkt, som forsåvidt også gjelder andre modeller, er at vi skal være klar over i hvilket område - x-verdier - modellen kan sies å være gyldig. Som vi ser av grafene ovenfor er det tildels store forskjeller i hva modellene vil predikere, og valg av modell må ses i sammenheng med det området vi har observasjoner og hvilket område vi ønsker å predikere i. Vi skal være ekstra observante når vi tenker på å gjøre prediksjoner i områder vi ikke har modellert, eller i områder vi ikke har hatt data på når vi har modellert.</p>
<div id="modellering-av-andregrads-quadratic-polynomisk-regresjon" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> Modellering av andregrads (“quadratic”) polynomisk regresjon<a class="anchor" aria-label="anchor" href="#modellering-av-andregrads-quadratic-polynomisk-regresjon"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb287"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">polydata</span><span class="op">$</span><span class="va">Stillingskategori2</span> <span class="op">&lt;-</span> <span class="va">polydata</span><span class="op">$</span><span class="va">Stillingskategori</span><span class="op">^</span><span class="fl">2</span>
<span class="fu">glimpse</span><span class="op">(</span><span class="va">polydata</span><span class="op">)</span>
<span class="co">#&gt; Rows: 10</span>
<span class="co">#&gt; Columns: 3</span>
<span class="co">#&gt; $ Stillingskategori  &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10</span>
<span class="co">#&gt; $ Snittlonn          &lt;dbl&gt; 35000, 41000, 48000, 63000, 880…</span>
<span class="co">#&gt; $ Stillingskategori2 &lt;dbl&gt; 1, 4, 9, 16, 25, 36, 49, 64, 81…</span></code></pre></div>
<p>Vi har altså laget en kvadrert variabel som heter Stillingskategori2. Lager så polynomial modell med ^2 ledd:</p>
<div class="sourceCode" id="cb288"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">poly_reg2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Snittlonn</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">polydata</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">polydata</span><span class="op">$</span><span class="va">Stillingskategori</span>, y <span class="op">=</span> <span class="va">polydata</span><span class="op">$</span><span class="va">Snittlonn</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">polydata</span><span class="op">$</span><span class="va">Stillingskategori</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">poly_reg2</span>, newdata <span class="op">=</span> <span class="va">polydata</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Polynomial regression ^2"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Stillingskategori"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Snittlønn"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="11_Kap_11_files/figure-html/unnamed-chunk-9-1.png" width="672"></div>
</div>
<div id="modellering-av-tredjegrads-cubic-polynomisk-regresjon" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> Modellering av tredjegrads (“cubic”) polynomisk regresjon<a class="anchor" aria-label="anchor" href="#modellering-av-tredjegrads-cubic-polynomisk-regresjon"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb289"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">polydata</span><span class="op">$</span><span class="va">Stillingskategori3</span> <span class="op">&lt;-</span> <span class="va">polydata</span><span class="op">$</span><span class="va">Stillingskategori</span><span class="op">^</span><span class="fl">3</span>
<span class="fu">glimpse</span><span class="op">(</span><span class="va">polydata</span><span class="op">)</span>
<span class="co">#&gt; Rows: 10</span>
<span class="co">#&gt; Columns: 4</span>
<span class="co">#&gt; $ Stillingskategori  &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10</span>
<span class="co">#&gt; $ Snittlonn          &lt;dbl&gt; 35000, 41000, 48000, 63000, 880…</span>
<span class="co">#&gt; $ Stillingskategori2 &lt;dbl&gt; 1, 4, 9, 16, 25, 36, 49, 64, 81…</span>
<span class="co">#&gt; $ Stillingskategori3 &lt;dbl&gt; 1, 8, 27, 64, 125, 216, 343, 51…</span></code></pre></div>
<div class="sourceCode" id="cb290"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">polydata</span><span class="op">$</span><span class="va">Stillingskategori3</span> <span class="op">&lt;-</span> <span class="va">polydata</span><span class="op">$</span><span class="va">Stillingskategori</span><span class="op">^</span><span class="fl">3</span>

<span class="va">poly_reg3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Snittlonn</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">polydata</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">polydata</span><span class="op">$</span><span class="va">Stillingskategori</span>, y <span class="op">=</span> <span class="va">polydata</span><span class="op">$</span><span class="va">Snittlonn</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">polydata</span><span class="op">$</span><span class="va">Stillingskategori</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">poly_reg3</span>, newdata <span class="op">=</span> <span class="va">polydata</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Polynomial regression ^3"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Stillingskategori"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Snittlønn"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="11_Kap_11_files/figure-html/unnamed-chunk-11-1.png" width="672"></div>
</div>
<div id="modellering-av-fjerdegrads-quartic-polynomisk-regresjon" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> Modellering av fjerdegrads (“quartic”) polynomisk regresjon<a class="anchor" aria-label="anchor" href="#modellering-av-fjerdegrads-quartic-polynomisk-regresjon"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb291"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">polydata</span><span class="op">$</span><span class="va">Stillingskategori4</span> <span class="op">&lt;-</span> <span class="va">polydata</span><span class="op">$</span><span class="va">Stillingskategori</span><span class="op">^</span><span class="fl">4</span>

<span class="va">poly_reg4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Snittlonn</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">polydata</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">polydata</span><span class="op">$</span><span class="va">Stillingskategori</span>, y <span class="op">=</span> <span class="va">polydata</span><span class="op">$</span><span class="va">Snittlonn</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">polydata</span><span class="op">$</span><span class="va">Stillingskategori</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">poly_reg4</span>, newdata <span class="op">=</span> <span class="va">polydata</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Polynomial regression ^4"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Stillingskategori"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Snittlønn"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="11_Kap_11_files/figure-html/unnamed-chunk-12-1.png" width="672"></div>
</div>
<div id="tolkning" class="section level2" number="11.4">
<h2>
<span class="header-section-number">11.4</span> Tolkning<a class="anchor" aria-label="anchor" href="#tolkning"><i class="fas fa-link"></i></a>
</h2>
<p>Av grafene over får vi en indikasjon på hvilken modell som ser ut til å passe våre data best. Vi kan også se på hvordan de ulike modellene predikerer ulikt. La oss f.eks. anta at man ønsker å innføre en stillingskategori 5.5. Hva er predikert snittlønn for denne kategorien?</p>
<div class="sourceCode" id="cb292"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Enkel OLS</span>
<span class="va">pred1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">enkelOLS</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Stillingskategori <span class="op">=</span> <span class="fl">5.5</span><span class="op">)</span><span class="op">)</span>
<span class="co"># ^4 polynomial</span>
<span class="va">pred2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">poly_reg4</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Stillingskategori <span class="op">=</span> <span class="fl">5.5</span>,
                              Stillingskategori2 <span class="op">=</span> <span class="fl">5.5</span><span class="op">^</span><span class="fl">2</span>,
                              Stillingskategori3 <span class="op">=</span> <span class="fl">5.5</span><span class="op">^</span><span class="fl">3</span>,
                              Stillingskategori4 <span class="op">=</span> <span class="fl">5.5</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">pred1</span>, <span class="va">pred2</span><span class="op">)</span><span class="op">)</span>
<span class="va">pred</span>
<span class="co">#&gt;   c(pred1, pred2)</span>
<span class="co">#&gt; 1          224500</span>
<span class="co">#&gt; 2          110250</span></code></pre></div>
<p>Vi kan se at det er en vesentlig forskjell i prediksjonene. Når vi ser på grafen for enkel OLS lenger opp ser vi også at regresjonslinja ligger godt over linja/punktene for dataene. Den siste av grafene - polynomial ^4 - ser ut til å treffe ganske bra.</p>
</div>
<div id="tilnæmring-gjennom-kryssvalidering---valg-av-antall-grader-i-polynomialfunksjonen" class="section level2" number="11.5">
<h2>
<span class="header-section-number">11.5</span> Tilnæmring gjennom kryssvalidering - valg av antall grader i polynomialfunksjonen<a class="anchor" aria-label="anchor" href="#tiln%C3%A6mring-gjennom-kryssvalidering---valg-av-antall-grader-i-polynomialfunksjonen"><i class="fas fa-link"></i></a>
</h2>
<p>Dette eksempelet er modifisert fra <span class="citation">Zach (2019a)</span>.</p>
<p>Vi kan tilnærme oss valg av riktig polynomialfunksjon gjennom “Mean Squared Error” (MSE) som forteller oss hvor nærme en regresjonslinje er datapunktene. Jo lavere MSE, jo bedre kan vi anta prediksjonsevnen til modellen er. Vi skal ikke gå i dybden på dette, men vise hvordan dette kan se ut for eksempelet ovenfor. I eksempelet brukes det som kalles “k-fold cross-validation” som vi ikke går nærmere inn på (men som vi forklarte i kapittelet om Principal Component Analysis). Utregning av MSE følger av:</p>
<p><span class="math inline">\(MSE = \frac{1}{n}*\sum(faktisk\ verdi - predikert\ verdi)\)</span></p>
<p>I eksempelet har vi generert data som ser på timer studenter har brukt på et emne og respektive resultater.</p>
<div class="sourceCode" id="cb293"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>timer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">5</span>, <span class="fl">15</span><span class="op">)</span>, resultat<span class="op">=</span><span class="fl">50</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">resultat</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">resultat</span> <span class="op">+</span> <span class="va">df</span><span class="op">$</span><span class="va">timer</span><span class="op">^</span><span class="fl">3</span><span class="op">/</span><span class="fl">150</span> <span class="op">+</span> <span class="va">df</span><span class="op">$</span><span class="va">timer</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>
<span class="fu">glimpse</span><span class="op">(</span><span class="va">df</span><span class="op">)</span>
<span class="co">#&gt; Rows: 50</span>
<span class="co">#&gt; Columns: 2</span>
<span class="co">#&gt; $ timer    &lt;dbl&gt; 7.655087, 8.721239, 10.728534, 14.082078,…</span>
<span class="co">#&gt; $ resultat &lt;dbl&gt; 64.30191, 70.65430, 73.66114, 86.14630, 5…</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">timer</span>, y <span class="op">=</span> <span class="va">resultat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="11_Kap_11_files/figure-html/unnamed-chunk-14-1.png" width="672"></div>
<p>Vi kan se på en enkel OLS på datasettet:</p>
<div class="sourceCode" id="cb294"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">enkelOLS2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">resultat</span> <span class="op">~</span> <span class="va">timer</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">timer</span>, y <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">resultat</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">timer</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">enkelOLS2</span>, newdata <span class="op">=</span> <span class="va">df</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Enkel OLS"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"timer"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"resultat"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="11_Kap_11_files/figure-html/unnamed-chunk-15-1.png" width="672"></div>
<p>Neste steg er å lage 5 modeller (kan selvsagt lage x antall modeller).</p>
<div class="sourceCode" id="cb295"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Stokker om dataene tilfeldig</span>
<span class="va">df.shuffled</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span>

<span class="co"># Setter antall "folds" som skal brukes i "k-fold cross-validation"</span>
<span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">10</span> 

<span class="co"># Definerer antall polynomfunksjoner</span>
<span class="va">degree</span> <span class="op">&lt;-</span> <span class="fl">5</span>

<span class="co"># Lager k antall like store "folds"</span>
<span class="va">folds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df.shuffled</span><span class="op">)</span><span class="op">)</span>,breaks<span class="op">=</span><span class="va">K</span>,labels<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># Lager matrise som skal fylles med MSE for de 5 modellene</span>
<span class="va">mse</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="cn">NA</span>,nrow<span class="op">=</span><span class="va">K</span>,ncol<span class="op">=</span><span class="va">degree</span><span class="op">)</span>

<span class="co"># Gjennomfører "K-fold cross validation"</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">K</span><span class="op">)</span><span class="op">{</span>
    
    <span class="co"># Deler opp i treningsdata og testdata</span>
    <span class="va">testIndexes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">folds</span><span class="op">==</span><span class="va">i</span>,arr.ind<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
    <span class="va">testData</span> <span class="op">&lt;-</span> <span class="va">df.shuffled</span><span class="op">[</span><span class="va">testIndexes</span>, <span class="op">]</span>
    <span class="va">trainData</span> <span class="op">&lt;-</span> <span class="va">df.shuffled</span><span class="op">[</span><span class="op">-</span><span class="va">testIndexes</span>, <span class="op">]</span>
    
    <span class="co"># Evaluerer modellene gjennom "k-fold cv" </span>
    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">degree</span><span class="op">)</span><span class="op">{</span>
        <span class="va">fit.train</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">resultat</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">timer</span>,<span class="va">j</span><span class="op">)</span>, data<span class="op">=</span><span class="va">trainData</span><span class="op">)</span>
        <span class="va">fit.test</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit.train</span>, newdata<span class="op">=</span><span class="va">testData</span><span class="op">)</span>
        <span class="va">mse</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">fit.test</span><span class="op">-</span> <span class="va">testData</span><span class="op">$</span><span class="va">resultat</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> 
    <span class="op">}</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="va">mse</span><span class="op">)</span>
<span class="co">#&gt; [1]  9.886172  8.589655  9.439514 10.214915 12.745574</span></code></pre></div>
<p>Vi kan til slutt visualisere valgt modell og se på modellen parametere.</p>
<div class="sourceCode" id="cb296"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">timer</span>, y<span class="op">=</span><span class="va">resultat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">'lm'</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> 
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">'timer'</span><span class="op">)</span> <span class="op">+</span>
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">'resultat'</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="11_Kap_11_files/figure-html/unnamed-chunk-17-1.png" width="672"></div>
<div class="sourceCode" id="cb297"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">bestemodell</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">resultat</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">timer</span>,<span class="fl">2</span>, raw<span class="op">=</span><span class="cn">T</span><span class="op">)</span>, data<span class="op">=</span><span class="va">df</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bestemodell</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = resultat ~ poly(timer, 2, raw = T), data = df)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -5.6589 -2.0770 -0.4599  2.5923  4.5122 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                          Estimate Std. Error t value</span>
<span class="co">#&gt; (Intercept)              54.00526    5.52855   9.768</span>
<span class="co">#&gt; poly(timer, 2, raw = T)1 -0.07904    1.15413  -0.068</span>
<span class="co">#&gt; poly(timer, 2, raw = T)2  0.18596    0.05724   3.249</span>
<span class="co">#&gt;                          Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)              6.78e-13 ***</span>
<span class="co">#&gt; poly(timer, 2, raw = T)1  0.94569    </span>
<span class="co">#&gt; poly(timer, 2, raw = T)2  0.00214 ** </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  </span>
<span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 2.8 on 47 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:   0.93,  Adjusted R-squared:  0.927 </span>
<span class="co">#&gt; F-statistic: 312.1 on 2 and 47 DF,  p-value: &lt; 2.2e-16</span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="iv-regresjon.html"><span class="header-section-number">10</span> IV regresjon</a></div>
<div class="next"><a href="logistisk-regresjon.html"><span class="header-section-number">12</span> Logistisk regresjon</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#polynomisk-regresjon"><span class="header-section-number">11</span> Polynomisk regresjon</a></li>
<li><a class="nav-link" href="#modellering-av-andregrads-quadratic-polynomisk-regresjon"><span class="header-section-number">11.1</span> Modellering av andregrads (“quadratic”) polynomisk regresjon</a></li>
<li><a class="nav-link" href="#modellering-av-tredjegrads-cubic-polynomisk-regresjon"><span class="header-section-number">11.2</span> Modellering av tredjegrads (“cubic”) polynomisk regresjon</a></li>
<li><a class="nav-link" href="#modellering-av-fjerdegrads-quartic-polynomisk-regresjon"><span class="header-section-number">11.3</span> Modellering av fjerdegrads (“quartic”) polynomisk regresjon</a></li>
<li><a class="nav-link" href="#tolkning"><span class="header-section-number">11.4</span> Tolkning</a></li>
<li><a class="nav-link" href="#tiln%C3%A6mring-gjennom-kryssvalidering---valg-av-antall-grader-i-polynomialfunksjonen"><span class="header-section-number">11.5</span> Tilnæmring gjennom kryssvalidering - valg av antall grader i polynomialfunksjonen</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/nilskvilvang/AKA3/blob/master/11_Kap_11.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/nilskvilvang/AKA3/edit/master/11_Kap_11.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Anvendt kvantitativ analyse</strong>" was written by Nils Kvilvang. It was last built on 09 juli, 2022.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
